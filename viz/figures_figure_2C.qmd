# Figure 2C {.unnumbered}

```{r}
#| eval: false
#| results: "asis"
#| echo: false
source("../_common.R")
suppressMessages(suppressPackageStartupMessages(library("Seurat")))
suppressMessages(library("magrittr"))
```

```{r}
#| eval: false
# Enrique Blanco Carmona
# e.blancocarmona@kitz-heidelberg.de
# PhD Student â€“ Clinical Bioinformatics
# Division of Pediatric Neurooncology (B062)
# DKFZ-KiTZ | Germany

# Read in sample.
sample <- readRDS("/omics/odcf/analysis/OE0145_projects/idh_gliomas/Figures_Science/revision/IDH_gliomas_book/datasets/integrated_LGGs.rds")

# Subset tumor cells.
sample <- sample[, sample$relabelling %in% c("Astro-like", "RA", "OPC-like", "Gradient", "Cycling")]
sample$relabelling[sample$relabelling == "RA"] <- "RE"
sample$subtype = factor(sample$subtype, levels = c("Oligodendroglioma", "Astrocytoma"))
# Read in TF activities.
dorothea_activities <- readRDS("/omics/odcf/analysis/OE0145_projects/idh_gliomas/Figures_Science/revision/IDH_gliomas_book/datasets/primary_dorothea.rds")
```

```{r}
#| eval: false
p <- SCpubr::do_TFActivityPlot(sample = sample,
                               activities = dorothea_activities,
                               n_tfs = 30,
                               split.by = "subtype",
                               group.by = c("relabelling"),
                               max.cutoff = 1, 
                               min.cutoff = -1,
                               font.size = 12,
                               axis.text.face = "plain") +
     ggplot2::xlab("Regulon") +
     ggplot2::ylab("Cell type")

p$guides$fill$title <- "Regulon score"
p <- p + ggplot2::theme(plot.margin = ggplot2::margin(t = 0, r = 0, b = 0, l = 0))

```

```{r}
#| eval: false
#| echo: false
#| warning: false
#| message: false
SCpubr::save_Plot(plot = p,
                  figure_path = "/omics/odcf/analysis/OE0145_projects/idh_gliomas/Figures_Science/revision/IDH_gliomas_book/figs/Figure_2C",
                  file_name = "Figure_2C",
                  dpi = 300,
                  width = 12.66,
                  height = 6.33,
                  output_format = "publication")
```
<img src="../figs/Figure_2C/Figure_2C.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"/>
