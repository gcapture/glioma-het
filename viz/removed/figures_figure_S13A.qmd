# Figure S13A {.unnumbered}

```{r}
#| eval: false
#| results: "asis"
#| echo: false
source("../_common.R")
suppressMessages(suppressPackageStartupMessages(library("Seurat")))
suppressMessages(library("magrittr"))
```

```{r}
#| eval: false
# Inma Hernandez Lopez
# inmaculada.hernandez-lopez@ukr.de
# LIT -  Leibniz-Institute für Immunotherapie

# Marc Elosua Bayés
# marc.elosua@cnag.crg.eu
# CNAG - CRG

# Enrique Blanco Carmona
# e.blancocarmona@kitz-heidelberg.de
# PhD Student – Clinical Bioinformatics
# Division of Pediatric Neurooncology (B062)
# DKFZ-KiTZ | Germany

proportions <- readRDS("/omics/odcf/analysis/OE0145_projects/idh_gliomas/Figures_Science/revision/IDH_gliomas_book/datasets/spotlight_deconv_LGG_microglia_TCGA.rds")
proportions <- proportions %>% 
               data.frame(check.names = FALSE) %>%
               tibble::rownames_to_column("ID") %>%
               tidyr::pivot_longer(cols = -ID,
                                   names_to = "cell_type",
                                   values_to = "proportion")
cluster_cols <- c("Mg Homeostatic"= "#ECA809",                          
                  "Mg Inflammatory TAMs" = "#043362",                  
                  "Mg Activated"= "#9A031E",                 
                  "Mg Resident−like TAMs"= "#009FF5",                    
                  "BMD Anti−inflammatory TAMs"= "#BC5210",            
                  "Mg Phagocytic"= "#279185",                 
                  "Mg IFNg TAMs"= "#7EB356",                   
                  "Mg Stressed TAMs"= "#AC70FF",                  
                  "Mg Inflammatory ICAM1+"= "#63412C",                  
                  "BAMs" = "#5F0F40")
```


```{r}
#| eval: false
p <- proportions %>% 
     ggplot2::ggplot(mapping = ggplot2::aes(x = .data$ID,
                                            y = .data$proportion,
                                            fill = .data$cell_type)) + 
     ggplot2::geom_col(color = "black", position = "fill") + 
     ggplot2::scale_fill_manual(values = cluster_cols, name = "") + 
     ggplot2::theme_minimal(base_size = 12) +
     ggplot2::labs(x = "TCGA Datasets",
                   y = "Proportion") +
     ggplot2::theme(axis.title = ggplot2::element_text(color = "black",
                                                       face = "bold"),
                    axis.line.x = ggplot2::element_blank(),
                    axis.line.y = ggplot2::element_blank(),
                    axis.text.x = ggplot2::element_blank(),
                    axis.text.y = ggplot2::element_text(color = "black", face = "bold"),
                    axis.ticks.y = ggplot2::element_line(color = "black"),
                    axis.ticks.x = ggplot2::element_blank(),
                    plot.title.position = "plot",
                    plot.title = ggplot2::element_text(face = "bold", hjust = 0.5),
                    plot.subtitle = ggplot2::element_text(face = "plain", hjust = 0),
                    plot.caption = ggplot2::element_text(face = "plain", hjust = 1),
                    panel.grid = ggplot2::element_blank(),
                    text = ggplot2::element_text(family = "sans"),
                    plot.caption.position = "plot",
                    legend.text = ggplot2::element_text(face = "plain"),
                    legend.position = "bottom",
                    legend.title = ggplot2::element_text(face = "bold"),
                    legend.justification = "center",
                    plot.margin = ggplot2::margin(t = 0, r = 10, b = 0, l = 10),
                    plot.background = ggplot2::element_rect(fill = "white", color = "white"),
                    panel.background = ggplot2::element_rect(fill = "white", color = "white"),
                    legend.background = ggplot2::element_rect(fill = "white", color = "white"),
                    strip.text = ggplot2::element_text(color = "black", face = "bold"),
                    strip.background = ggplot2::element_blank())

```

```{r}
#| eval: false
#| echo: false
#| warning: false
#| message: false
SCpubr::save_Plot(p,
                  figure_path = "/omics/odcf/analysis/OE0145_projects/idh_gliomas/Figures_Science/revision/IDH_gliomas_book/figs/Figure_S13A",
                  file_name = "Figure_S13A",
                  dpi = 300,
                  output_format = "publication",
                  width = 25,
                  height = 15)
```


<img src="../figs/Figure_S13A/Figure_S13A.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"/>

